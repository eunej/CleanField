{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/ej/Hackathon/VeriFarm/lib/data/mockData.ts"],"sourcesContent":["import { Farm, BurningRecord, InsurancePayment } from '@/lib/types/farm';\n\n// Mock farm data\nexport const MOCK_FARMS: Farm[] = [\n  {\n    id: 'farm1',\n    name: 'Green Valley Farm',\n    owner: 'สมชาย ใจดี',\n    walletAddress: '0x1234567890123456789012345678901234567890',\n    location: { lat: 13.7563, lng: 100.5018 },\n    area: 25.5,\n    registrationDate: '2024-01-15',\n    lastCheckDate: '2026-01-28',\n    hasBurning: false,\n    burningIncidents: 0,\n    insuranceStatus: 'active',\n    rewardAmount: 500,\n  },\n  {\n    id: 'farm2',\n    name: 'Sunrise Orchards',\n    owner: 'นิรันดร์ สุขสวัสดิ์',\n    walletAddress: '0x2345678901234567890123456789012345678901',\n    location: { lat: 14.3532, lng: 100.5698 },\n    area: 18.2,\n    registrationDate: '2024-02-20',\n    lastCheckDate: '2026-01-28',\n    hasBurning: true,\n    burningIncidents: 2,\n    insuranceStatus: 'ineligible',\n    rewardAmount: 0,\n  },\n  {\n    id: 'farm3',\n    name: 'Golden Harvest Fields',\n    owner: 'อภิญญา วงศ์สกุล',\n    walletAddress: '0x3456789012345678901234567890123456789012',\n    location: { lat: 15.8700, lng: 100.9925 },\n    area: 42.0,\n    registrationDate: '2024-03-10',\n    lastCheckDate: '2026-01-28',\n    hasBurning: false,\n    burningIncidents: 0,\n    insuranceStatus: 'paid',\n    rewardAmount: 800,\n  },\n  {\n    id: 'farm4',\n    name: 'River Bend Agriculture',\n    owner: 'กิตติศักดิ์ เจริญผล',\n    walletAddress: '0x4567890123456789012345678901234567890123',\n    location: { lat: 16.4419, lng: 102.8359 },\n    area: 33.7,\n    registrationDate: '2024-04-05',\n    lastCheckDate: '2026-01-28',\n    hasBurning: false,\n    burningIncidents: 0,\n    insuranceStatus: 'pending',\n    rewardAmount: 650,\n  },\n  {\n    id: 'farm5',\n    name: 'Mountain View Plantation',\n    owner: 'ปราณี ศรีสุข',\n    walletAddress: '0x5678901234567890123456789012345678901234',\n    location: { lat: 18.7883, lng: 98.9853 },\n    area: 51.3,\n    registrationDate: '2024-05-12',\n    lastCheckDate: '2026-01-28',\n    hasBurning: true,\n    burningIncidents: 1,\n    insuranceStatus: 'ineligible',\n    rewardAmount: 0,\n  },\n];\n\n// Mock burning records\nexport const MOCK_BURNING_RECORDS: BurningRecord[] = [\n  {\n    farmId: 'farm2',\n    date: '2026-01-10',\n    severity: 'medium',\n    verified: true,\n  },\n  {\n    farmId: 'farm2',\n    date: '2026-01-22',\n    severity: 'low',\n    verified: true,\n  },\n  {\n    farmId: 'farm5',\n    date: '2026-01-18',\n    severity: 'high',\n    verified: true,\n  },\n];\n\n// Mock insurance payments\nexport const MOCK_PAYMENTS: InsurancePayment[] = [\n  {\n    farmId: 'farm1',\n    amount: 500,\n    timestamp: '2026-01-28T10:00:00Z',\n    status: 'pending',\n  },\n  {\n    farmId: 'farm3',\n    amount: 800,\n    timestamp: '2026-01-27T15:30:00Z',\n    txHash: '0xabcdef1234567890abcdef1234567890abcdef1234567890abcdef1234567890',\n    status: 'completed',\n  },\n  {\n    farmId: 'farm4',\n    amount: 650,\n    timestamp: '2026-01-28T09:15:00Z',\n    status: 'pending',\n  },\n];\n"],"names":[],"mappings":";;;;;;;;AAGO,MAAM,aAAqB;IAChC;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,eAAe;QACf,UAAU;YAAE,KAAK;YAAS,KAAK;QAAS;QACxC,MAAM;QACN,kBAAkB;QAClB,eAAe;QACf,YAAY;QACZ,kBAAkB;QAClB,iBAAiB;QACjB,cAAc;IAChB;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,eAAe;QACf,UAAU;YAAE,KAAK;YAAS,KAAK;QAAS;QACxC,MAAM;QACN,kBAAkB;QAClB,eAAe;QACf,YAAY;QACZ,kBAAkB;QAClB,iBAAiB;QACjB,cAAc;IAChB;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,eAAe;QACf,UAAU;YAAE,KAAK;YAAS,KAAK;QAAS;QACxC,MAAM;QACN,kBAAkB;QAClB,eAAe;QACf,YAAY;QACZ,kBAAkB;QAClB,iBAAiB;QACjB,cAAc;IAChB;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,eAAe;QACf,UAAU;YAAE,KAAK;YAAS,KAAK;QAAS;QACxC,MAAM;QACN,kBAAkB;QAClB,eAAe;QACf,YAAY;QACZ,kBAAkB;QAClB,iBAAiB;QACjB,cAAc;IAChB;IACA;QACE,IAAI;QACJ,MAAM;QACN,OAAO;QACP,eAAe;QACf,UAAU;YAAE,KAAK;YAAS,KAAK;QAAQ;QACvC,MAAM;QACN,kBAAkB;QAClB,eAAe;QACf,YAAY;QACZ,kBAAkB;QAClB,iBAAiB;QACjB,cAAc;IAChB;CACD;AAGM,MAAM,uBAAwC;IACnD;QACE,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;IACZ;IACA;QACE,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;IACZ;IACA;QACE,QAAQ;QACR,MAAM;QACN,UAAU;QACV,UAAU;IACZ;CACD;AAGM,MAAM,gBAAoC;IAC/C;QACE,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,QAAQ;IACV;IACA;QACE,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,QAAQ;QACR,QAAQ;IACV;IACA;QACE,QAAQ;QACR,QAAQ;QACR,WAAW;QACX,QAAQ;IACV;CACD"}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///Users/ej/Hackathon/VeriFarm/lib/payments/types.ts"],"sourcesContent":["// Payment Types for Clean Air Incentive System\n\nexport interface PaymentConfig {\n  contractAddress: string;\n  oracleContractAddress: string;\n  rewardPerHectare: number; // THB per hectare per year (e.g., 5000)\n  currency: string; // THB\n  claimPeriodDays: number; // e.g., 365 days (yearly)\n  network: 'sepolia' | 'mainnet';\n}\n\nexport interface ClaimRequest {\n  farmId: string;\n  walletAddress: string;\n  attestationId: string;\n  proofHash: string;\n  noBurningDetected: boolean;\n  timestamp: number;\n}\n\nexport interface ClaimResult {\n  success: boolean;\n  farmId: string;\n  walletAddress: string;\n  amount: number;\n  currency: string;\n  txHash?: string;\n  status: 'pending' | 'processing' | 'completed' | 'failed' | 'ineligible';\n  message: string;\n  claimedAt?: string;\n  eligibility: {\n    isEligible: boolean;\n    reason: string;\n    noBurningDetected: boolean;\n    proofVerified: boolean;\n    lastClaimDate?: string;\n    nextClaimDate?: string;\n  };\n}\n\nexport interface PaymentRecord {\n  id: string;\n  farmId: string;\n  walletAddress: string;\n  amount: number;\n  currency: string;\n  txHash: string;\n  status: 'pending' | 'completed' | 'failed';\n  attestationId: string;\n  proofHash: string;\n  createdAt: string;\n  completedAt?: string;\n}\n\nexport interface FarmPaymentHistory {\n  farmId: string;\n  totalClaimed: number;\n  totalPayments: number;\n  lastClaimDate?: string;\n  payments: PaymentRecord[];\n}\n\n// Smart Contract Types\nexport interface SmartContractConfig {\n  address: string;\n  abi: unknown[];\n  network: string;\n  rpcUrl: string;\n}\n\nexport interface OnChainProof {\n  farmId: string;\n  proofHash: string;\n  noBurningDetected: boolean;\n  timestamp: number;\n}\n"],"names":[],"mappings":"AAAA,+CAA+C"}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":["file:///Users/ej/Hackathon/VeriFarm/lib/payments/paymentService.ts"],"sourcesContent":["/**\n * Clean Air Incentive Payment Service\n * \n * Handles THB payments to farmers after zkTLS proof verification.\n * Reward: THB 5,000 per hectare per year for maintaining clean air practices.\n */\n\nimport {\n  PaymentConfig,\n  ClaimRequest,\n  ClaimResult,\n  PaymentRecord,\n  FarmPaymentHistory,\n} from './types';\nimport { MOCK_FARMS } from '@/lib/data/mockData';\n\n// Payment Configuration\nconst PAYMENT_CONFIG: PaymentConfig = {\n  contractAddress: process.env.NEXT_PUBLIC_PAYMENT_CONTRACT || '0x7169D38820dfd117C3FA1f22a697dBA58d90BA06',\n  oracleContractAddress: process.env.NEXT_PUBLIC_ORACLE_CONTRACT || '0x0000000000000000000000000000000000000000',\n  rewardPerHectare: 5000, // THB 5,000 per hectare per year\n  currency: 'THB',\n  claimPeriodDays: 365, // yearly claim\n  network: 'sepolia',\n};\n\n/**\n * Calculate reward amount based on farm area\n */\nexport function calculateRewardAmount(farmId: string): number {\n  const farm = MOCK_FARMS.find(f => f.id === farmId);\n  if (!farm) return 0;\n  // Reward = THB 5,000 × farm area (in hectares)\n  return Math.round(PAYMENT_CONFIG.rewardPerHectare * farm.area);\n}\n\n// In-memory storage for demo (would be database in production)\nconst paymentRecords: Map<string, PaymentRecord[]> = new Map();\nconst lastClaimDates: Map<string, string> = new Map();\n\n/**\n * Generate a mock transaction hash\n */\nfunction generateMockTxHash(): string {\n  const chars = '0123456789abcdef';\n  let hash = '0x';\n  for (let i = 0; i < 64; i++) {\n    hash += chars[Math.floor(Math.random() * chars.length)];\n  }\n  return hash;\n}\n\n/**\n * Check if a farm is eligible to claim reward\n */\nexport function checkClaimEligibility(\n  farmId: string,\n  noBurningDetected: boolean,\n  proofVerified: boolean\n): {\n  isEligible: boolean;\n  reason: string;\n  lastClaimDate?: string;\n  nextClaimDate?: string;\n  daysUntilNextClaim?: number;\n} {\n  // Check 1: Proof must show no burning\n  if (!noBurningDetected) {\n    return {\n      isEligible: false,\n      reason: 'Burning detected in zkTLS proof. Farm is not eligible for clean air incentive.',\n    };\n  }\n\n  // Check 2: Proof must be verified\n  if (!proofVerified) {\n    return {\n      isEligible: false,\n      reason: 'zkTLS proof verification failed. Please generate a new attestation.',\n    };\n  }\n\n  // Check 3: Must wait for claim period since last claim\n  const lastClaim = lastClaimDates.get(farmId);\n  if (lastClaim) {\n    const lastClaimDate = new Date(lastClaim);\n    const nextClaimDate = new Date(lastClaimDate);\n    nextClaimDate.setDate(nextClaimDate.getDate() + PAYMENT_CONFIG.claimPeriodDays);\n    \n    const now = new Date();\n    if (now < nextClaimDate) {\n      const daysUntilNextClaim = Math.ceil((nextClaimDate.getTime() - now.getTime()) / (1000 * 60 * 60 * 24));\n      return {\n        isEligible: false,\n        reason: `Must wait ${daysUntilNextClaim} more days before next claim. Claim period is ${PAYMENT_CONFIG.claimPeriodDays} days.`,\n        lastClaimDate: lastClaim,\n        nextClaimDate: nextClaimDate.toISOString(),\n        daysUntilNextClaim,\n      };\n    }\n  }\n\n  return {\n    isEligible: true,\n    reason: 'Farm is eligible for clean air incentive payment.',\n    lastClaimDate: lastClaim,\n    nextClaimDate: lastClaim \n      ? new Date(new Date(lastClaim).getTime() + PAYMENT_CONFIG.claimPeriodDays * 24 * 60 * 60 * 1000).toISOString()\n      : undefined,\n  };\n}\n\n/**\n * Process a clean air incentive claim\n * \n * This function:\n * 1. Verifies the claim eligibility\n * 2. Simulates the USDT transfer (would be real in production)\n * 3. Records the payment\n */\nexport async function processClaimReward(\n  request: ClaimRequest\n): Promise<ClaimResult> {\n  const { farmId, walletAddress, attestationId, proofHash, noBurningDetected, timestamp } = request;\n\n  // Check eligibility\n  const eligibility = checkClaimEligibility(farmId, noBurningDetected, true);\n\n  if (!eligibility.isEligible) {\n    return {\n      success: false,\n      farmId,\n      walletAddress,\n      amount: 0,\n      currency: 'USDT',\n      status: 'ineligible',\n      message: eligibility.reason,\n      eligibility: {\n        isEligible: false,\n        reason: eligibility.reason,\n        noBurningDetected,\n        proofVerified: true,\n        lastClaimDate: eligibility.lastClaimDate,\n        nextClaimDate: eligibility.nextClaimDate,\n      },\n    };\n  }\n\n  try {\n    // In production, this would:\n    // 1. Submit proof to SmogFreeOracle contract\n    // 2. Call claimReward() function\n    // 3. Wait for transaction confirmation\n    \n    // Simulate processing delay\n    await new Promise(resolve => setTimeout(resolve, 1500));\n\n    // Generate mock transaction hash\n    const txHash = generateMockTxHash();\n    const now = new Date().toISOString();\n    const rewardAmount = calculateRewardAmount(farmId);\n\n    // Create payment record\n    const payment: PaymentRecord = {\n      id: `pay_${farmId}_${Date.now()}`,\n      farmId,\n      walletAddress,\n      amount: rewardAmount,\n      currency: PAYMENT_CONFIG.currency,\n      txHash,\n      status: 'completed',\n      attestationId,\n      proofHash,\n      createdAt: now,\n      completedAt: now,\n    };\n\n    // Store payment record\n    const farmPayments = paymentRecords.get(farmId) || [];\n    farmPayments.push(payment);\n    paymentRecords.set(farmId, farmPayments);\n\n    // Update last claim date\n    lastClaimDates.set(farmId, now);\n\n    return {\n      success: true,\n      farmId,\n      walletAddress,\n      amount: rewardAmount,\n      currency: PAYMENT_CONFIG.currency,\n      txHash,\n      status: 'completed',\n      message: `Successfully transferred ฿${rewardAmount.toLocaleString()} to ${walletAddress.slice(0, 6)}...${walletAddress.slice(-4)}`,\n      claimedAt: now,\n      eligibility: {\n        isEligible: true,\n        reason: 'Claim processed successfully',\n        noBurningDetected: true,\n        proofVerified: true,\n        lastClaimDate: now,\n        nextClaimDate: new Date(Date.now() + PAYMENT_CONFIG.claimPeriodDays * 24 * 60 * 60 * 1000).toISOString(),\n      },\n    };\n  } catch (error) {\n    return {\n      success: false,\n      farmId,\n      walletAddress,\n      amount: 0,\n      currency: 'USDT',\n      status: 'failed',\n      message: error instanceof Error ? error.message : 'Payment processing failed',\n      eligibility: {\n        isEligible: true,\n        reason: 'Eligible but payment failed',\n        noBurningDetected,\n        proofVerified: true,\n      },\n    };\n  }\n}\n\n/**\n * Get payment history for a farm\n */\nexport function getFarmPaymentHistory(farmId: string): FarmPaymentHistory {\n  const payments = paymentRecords.get(farmId) || [];\n  const completedPayments = payments.filter(p => p.status === 'completed');\n  const totalClaimed = completedPayments.reduce((sum, p) => sum + p.amount, 0);\n\n  return {\n    farmId,\n    totalClaimed,\n    totalPayments: completedPayments.length,\n    lastClaimDate: lastClaimDates.get(farmId),\n    payments,\n  };\n}\n\n/**\n * Get payment configuration (public info)\n */\nexport function getPaymentConfig() {\n  return {\n    paymentContract: PAYMENT_CONFIG.contractAddress,\n    oracleContract: PAYMENT_CONFIG.oracleContractAddress,\n    rewardPerHectare: PAYMENT_CONFIG.rewardPerHectare,\n    currency: PAYMENT_CONFIG.currency,\n    claimPeriodDays: PAYMENT_CONFIG.claimPeriodDays,\n    network: PAYMENT_CONFIG.network,\n  };\n}\n\n/**\n * Estimate gas for claim transaction\n */\nexport function estimateClaimGas(): {\n  gasLimit: string;\n  estimatedCostEth: string;\n  estimatedCostUsd: string;\n} {\n  // Mock gas estimation\n  return {\n    gasLimit: '150000',\n    estimatedCostEth: '0.003',\n    estimatedCostUsd: '$7.50',\n  };\n}\n\n/**\n * Get all pending claims\n */\nexport function getPendingClaims(): PaymentRecord[] {\n  const allPending: PaymentRecord[] = [];\n  paymentRecords.forEach(payments => {\n    payments.filter(p => p.status === 'pending').forEach(p => allPending.push(p));\n  });\n  return allPending;\n}\n\n/**\n * Get total distributed rewards\n */\nexport function getTotalDistributed(): {\n  totalAmount: number;\n  totalClaims: number;\n  uniqueFarms: number;\n} {\n  let totalAmount = 0;\n  let totalClaims = 0;\n  const uniqueFarms = new Set<string>();\n\n  paymentRecords.forEach((payments, farmId) => {\n    const completed = payments.filter(p => p.status === 'completed');\n    if (completed.length > 0) {\n      uniqueFarms.add(farmId);\n      totalClaims += completed.length;\n      totalAmount += completed.reduce((sum, p) => sum + p.amount, 0);\n    }\n  });\n\n  return {\n    totalAmount,\n    totalClaims,\n    uniqueFarms: uniqueFarms.size,\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 436, "column": 0}, "map": {"version":3,"sources":["file:///Users/ej/Hackathon/VeriFarm/lib/payments/index.ts"],"sourcesContent":["/**\n * Clean Air Incentive Payment System\n * \n * This module handles THB payments to farmers who submit valid\n * zkTLS proofs showing no burning detected.\n * Reward: THB 5,000 per hectare per year.\n */\n\nexport * from './types';\nexport * from './paymentService';\n\n// Re-export main functions\nexport {\n  processClaimReward,\n  checkClaimEligibility,\n  getFarmPaymentHistory,\n  getPaymentConfig,\n  estimateClaimGas,\n  getPendingClaims,\n  getTotalDistributed,\n  calculateRewardAmount,\n} from './paymentService';\n"],"names":[],"mappings":";AAAA;;;;;;CAMC,GAED;AACA"}},
    {"offset": {"line": 452, "column": 0}, "map": {"version":3,"sources":["file:///Users/ej/Hackathon/VeriFarm/app/api/claim/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\nimport { MOCK_FARMS } from '@/lib/data/mockData';\nimport {\n  processClaimReward,\n  checkClaimEligibility,\n  getPaymentConfig,\n  estimateClaimGas,\n  getTotalDistributed,\n  calculateRewardAmount,\n  ClaimRequest,\n} from '@/lib/payments';\n\n/**\n * POST /api/claim\n * \n * Claim clean air incentive payment after zkTLS proof submission\n * \n * Request body:\n * - farmId: string - Farm identifier\n * - attestationId: string - zkTLS attestation ID\n * - proofHash: string - Cryptographic proof hash\n * - noBurningDetected: boolean - Whether the proof shows no burning\n * - timestamp: number - Attestation timestamp\n * \n * Response:\n * - ClaimResult with payment status and transaction hash\n */\nexport async function POST(request: Request) {\n  try {\n    const body = await request.json();\n    const { farmId, attestationId, proofHash, noBurningDetected, timestamp } = body;\n\n    // Validate required fields\n    if (!farmId || !attestationId || !proofHash || noBurningDetected === undefined) {\n      return NextResponse.json(\n        {\n          success: false,\n          error: 'Missing required fields: farmId, attestationId, proofHash, noBurningDetected',\n        },\n        { status: 400 }\n      );\n    }\n\n    // Find farm\n    const farm = MOCK_FARMS.find(f => f.id === farmId);\n    if (!farm) {\n      return NextResponse.json(\n        { success: false, error: 'Farm not found' },\n        { status: 404 }\n      );\n    }\n\n    // Create claim request\n    const claimRequest: ClaimRequest = {\n      farmId,\n      walletAddress: farm.walletAddress,\n      attestationId,\n      proofHash,\n      noBurningDetected,\n      timestamp: timestamp || Date.now(),\n    };\n\n    // Process the claim\n    const result = await processClaimReward(claimRequest);\n\n    return NextResponse.json({\n      ...result,\n      farm: {\n        id: farm.id,\n        name: farm.name,\n        owner: farm.owner,\n      },\n      config: getPaymentConfig(),\n    });\n  } catch (error) {\n    console.error('Claim processing error:', error);\n    return NextResponse.json(\n      {\n        success: false,\n        error: error instanceof Error ? error.message : 'Claim processing failed',\n      },\n      { status: 500 }\n    );\n  }\n}\n\n/**\n * GET /api/claim\n * \n * Get claim eligibility and payment configuration\n * \n * Query params:\n * - farmId: string - Farm identifier (optional, returns general info if not provided)\n */\nexport async function GET(request: Request) {\n  const { searchParams } = new URL(request.url);\n  const farmId = searchParams.get('farmId');\n\n  const config = getPaymentConfig();\n  const gasEstimate = estimateClaimGas();\n  const totalDistributed = getTotalDistributed();\n\n  if (farmId) {\n    const farm = MOCK_FARMS.find(f => f.id === farmId);\n    if (!farm) {\n      return NextResponse.json(\n        { success: false, error: 'Farm not found' },\n        { status: 404 }\n      );\n    }\n\n    // Check eligibility (assuming no burning for eligibility check)\n    const eligibility = checkClaimEligibility(farmId, !farm.hasBurning, true);\n\n    return NextResponse.json({\n      success: true,\n      farmId,\n      farm: {\n        name: farm.name,\n        owner: farm.owner,\n        walletAddress: farm.walletAddress,\n        hasBurning: farm.hasBurning,\n        area: farm.area,\n        calculatedReward: calculateRewardAmount(farmId),\n      },\n      eligibility,\n      config,\n      gasEstimate,\n    });\n  }\n\n  return NextResponse.json({\n    success: true,\n    name: 'Clean Air Incentive Payment System',\n    description: 'Submit zkTLS proof of no burning to claim THB rewards (฿5,000/ha/year)',\n    config,\n    gasEstimate,\n    stats: totalDistributed,\n    endpoints: {\n      claim: 'POST /api/claim',\n      checkEligibility: 'GET /api/claim?farmId=<farmId>',\n      history: 'GET /api/claim/history?farmId=<farmId>',\n    },\n  });\n}\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AAAA;;;;AAyBO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,iBAAiB,EAAE,SAAS,EAAE,GAAG;QAE3E,2BAA2B;QAC3B,IAAI,CAAC,UAAU,CAAC,iBAAiB,CAAC,aAAa,sBAAsB,WAAW;YAC9E,OAAO,gJAAY,CAAC,IAAI,CACtB;gBACE,SAAS;gBACT,OAAO;YACT,GACA;gBAAE,QAAQ;YAAI;QAElB;QAEA,YAAY;QACZ,MAAM,OAAO,uIAAU,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAC3C,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAiB,GAC1C;gBAAE,QAAQ;YAAI;QAElB;QAEA,uBAAuB;QACvB,MAAM,eAA6B;YACjC;YACA,eAAe,KAAK,aAAa;YACjC;YACA;YACA;YACA,WAAW,aAAa,KAAK,GAAG;QAClC;QAEA,oBAAoB;QACpB,MAAM,SAAS,MAAM,IAAA,yJAAkB,EAAC;QAExC,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,GAAG,MAAM;YACT,MAAM;gBACJ,IAAI,KAAK,EAAE;gBACX,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;YACnB;YACA,QAAQ,IAAA,uJAAgB;QAC1B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,2BAA2B;QACzC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,OAAO,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QAClD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF;AAUO,eAAe,IAAI,OAAgB;IACxC,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;IAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;IAEhC,MAAM,SAAS,IAAA,uJAAgB;IAC/B,MAAM,cAAc,IAAA,uJAAgB;IACpC,MAAM,mBAAmB,IAAA,0JAAmB;IAE5C,IAAI,QAAQ;QACV,MAAM,OAAO,uIAAU,CAAC,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAC3C,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,SAAS;gBAAO,OAAO;YAAiB,GAC1C;gBAAE,QAAQ;YAAI;QAElB;QAEA,gEAAgE;QAChE,MAAM,cAAc,IAAA,4JAAqB,EAAC,QAAQ,CAAC,KAAK,UAAU,EAAE;QAEpE,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT;YACA,MAAM;gBACJ,MAAM,KAAK,IAAI;gBACf,OAAO,KAAK,KAAK;gBACjB,eAAe,KAAK,aAAa;gBACjC,YAAY,KAAK,UAAU;gBAC3B,MAAM,KAAK,IAAI;gBACf,kBAAkB,IAAA,4JAAqB,EAAC;YAC1C;YACA;YACA;YACA;QACF;IACF;IAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;QACvB,SAAS;QACT,MAAM;QACN,aAAa;QACb;QACA;QACA,OAAO;QACP,WAAW;YACT,OAAO;YACP,kBAAkB;YAClB,SAAS;QACX;IACF;AACF"}}]
}